<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>利用Velero对K8S备份还原与集群迁移实战 | 皮特ᴾᵗ的博客技术站</title>
    <meta name="description" content="热衷于网络安全、云原生技术，一直为实现自我价值而执着！">
    <meta name="generator" content="VitePress v1.0.2">
    <link rel="preload stylesheet" href="/assets/style.Bzp2SyhN.css" as="style">
    
    <script type="module" src="/assets/app.BIcRMknm.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Bu8hRsVA.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.Cst8pIsI.js">
    <link rel="modulepreload" href="/assets/chunks/theme.BiqLTbwr.js">
    <link rel="modulepreload" href="/assets/posts_velero_intro-and-practice.md.Cv-O3FKW.lean.js">
    <link rel="icon" href="/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <script>import("/pagefind/pagefind.js").then(i=>{window.__pagefind__=i,i.init()}).catch(()=>{});</script>
  </head>
  <body>
    <div id="app"><div class="Layout blog-theme-layout" data-v-76f3735e data-v-8916ddb1><!--[--><!--[--><!--]--><!----><!--]--><!--[--><span tabindex="-1" data-v-10a5af8e></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-10a5af8e> Skip to content </a><!--]--><!----><header class="VPNav" data-v-8916ddb1 data-v-733e1209><div class="VPNavBar top" data-v-733e1209 data-v-bad45cb7><div class="wrapper" data-v-bad45cb7><div class="container" data-v-bad45cb7><div class="title" data-v-bad45cb7><div class="VPNavBarTitle" data-v-bad45cb7 data-v-b59f26e3><a class="title" href="/" data-v-b59f26e3><!--[--><!--]--><!--[--><img class="VPImage logo" src="/favicon.ico" alt data-v-8ac17cee><!--]--><span data-v-b59f26e3>皮特ᴾᵗ的博客技术站</span><!--[--><!--]--></a></div></div><div class="content" data-v-bad45cb7><div class="content-body" data-v-bad45cb7><!--[--><!--]--><div class="blog-search search" data-pagefind-ignore="all" data-v-bad45cb7 data-v-6bd16904><div class="nav-search-btn-wait" data-v-6bd16904><span data-v-6bd16904><svg width="14" height="14" viewBox="0 0 20 20" data-v-6bd16904><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" data-v-6bd16904></path></svg></span><span class="search-tip" data-v-6bd16904>Search</span><span class="metaKey" data-v-6bd16904> K </span></div><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-bad45cb7 data-v-41c6788a><span id="main-nav-aria-label" class="visually-hidden" data-v-41c6788a>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-41c6788a data-v-9efefe17><!--[--><span data-v-9efefe17>首页</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-41c6788a data-v-d39771ea><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-d39771ea><span class="text" data-v-d39771ea><!----><span data-v-d39771ea>面试</span><span class="vpi-chevron-down text-icon" data-v-d39771ea></span></span></button><div class="menu" data-v-d39771ea><div class="VPMenu" data-v-d39771ea data-v-7a0abf47><div class="items" data-v-7a0abf47><!--[--><!--[--><div class="VPMenuLink" data-v-7a0abf47 data-v-ad366352><a class="VPLink link" href="/posts/interview/tcp.html" data-v-ad366352><!--[-->TCP篇<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-41c6788a data-v-d39771ea><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-d39771ea><span class="text" data-v-d39771ea><!----><span data-v-d39771ea>趣味</span><span class="vpi-chevron-down text-icon" data-v-d39771ea></span></span></button><div class="menu" data-v-d39771ea><div class="VPMenu" data-v-d39771ea data-v-7a0abf47><div class="items" data-v-7a0abf47><!--[--><!--[--><div class="VPMenuLink" data-v-7a0abf47 data-v-ad366352><a class="VPLink link" href="/fun/catch-the-cat.html" data-v-ad366352><!--[-->逮住那只猫！<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/aboutme.html" tabindex="0" data-v-41c6788a data-v-9efefe17><!--[--><span data-v-9efefe17>关于我</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-bad45cb7 data-v-5d196dc8><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-5d196dc8 data-v-70c6a21a data-v-3a63e9c6><span class="check" data-v-3a63e9c6><span class="icon" data-v-3a63e9c6><!--[--><span class="vpi-sun sun" data-v-70c6a21a></span><span class="vpi-moon moon" data-v-70c6a21a></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-bad45cb7 data-v-8105973d data-v-5c5801c3><!--[--><a class="VPSocialLink no-icon" href="https://github.com/hyperter96/tech-blog" aria-label="github" target="_blank" rel="noopener" data-v-5c5801c3 data-v-142beb15><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-bad45cb7 data-v-781ed953 data-v-d39771ea><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-d39771ea><span class="vpi-more-horizontal icon" data-v-d39771ea></span></button><div class="menu" data-v-d39771ea><div class="VPMenu" data-v-d39771ea data-v-7a0abf47><!----><!--[--><!--[--><!----><div class="group" data-v-781ed953><div class="item appearance" data-v-781ed953><p class="label" data-v-781ed953>Appearance</p><div class="appearance-action" data-v-781ed953><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-781ed953 data-v-70c6a21a data-v-3a63e9c6><span class="check" data-v-3a63e9c6><span class="icon" data-v-3a63e9c6><!--[--><span class="vpi-sun sun" data-v-70c6a21a></span><span class="vpi-moon moon" data-v-70c6a21a></span><!--]--></span></span></button></div></div></div><div class="group" data-v-781ed953><div class="item social-links" data-v-781ed953><div class="VPSocialLinks social-links-list" data-v-781ed953 data-v-5c5801c3><!--[--><a class="VPSocialLink no-icon" href="https://github.com/hyperter96/tech-blog" aria-label="github" target="_blank" rel="noopener" data-v-5c5801c3 data-v-142beb15><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="阅读增强插件" role="menuitem" data-v-202de4de><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-202de4de><span class="text" data-v-202de4de><span class="i-icon-park-outline:book-open option-icon" data-v-202de4de></span><!----><span class="vpi-chevron-down text-icon" data-v-202de4de></span></span></button><div class="menu" data-v-202de4de><div class="VPMenu" data-v-b9f48d30 data-v-202de4de><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-bad45cb7 data-v-c9eec80a><span class="container" data-v-c9eec80a><span class="top" data-v-c9eec80a></span><span class="middle" data-v-c9eec80a></span><span class="bottom" data-v-c9eec80a></span></span></button></div></div></div></div><div class="divider" data-v-bad45cb7><div class="divider-line" data-v-bad45cb7></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-8916ddb1 data-v-9f34cd5c><div class="container" data-v-9f34cd5c><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-9f34cd5c data-v-d807353f><button data-v-d807353f>回到顶部</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-pagefind-body data-v-8916ddb1 data-v-ab4b3770><div class="VPDoc has-aside" data-v-ab4b3770 data-v-58e86873><!--[--><!--]--><div class="container" data-v-58e86873><div class="aside" data-v-58e86873><div class="aside-curtain" data-v-58e86873></div><div class="aside-container" data-v-58e86873><div class="aside-content" data-v-58e86873><div class="VPDocAside" data-v-58e86873 data-v-296b82e0><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-296b82e0 data-v-8556ca0d><div class="content" data-v-8556ca0d><div class="outline-marker" data-v-8556ca0d></div><div class="outline-title" role="heading" aria-level="2" data-v-8556ca0d>目录</div><nav aria-labelledby="doc-outline-aria-label" data-v-8556ca0d><span class="visually-hidden" id="doc-outline-aria-label" data-v-8556ca0d> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-8556ca0d data-v-d802287d><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-296b82e0></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-58e86873><div class="content-container" data-v-58e86873><!--[--><!--[--><!--[--><!--[--><!--]--><!----><!--]--><!--]--><!--]--><main class="main" data-v-58e86873><div style="position:relative;" class="vp-doc _posts_velero_intro-and-practice" data-v-58e86873><div><h1 id="利用velero对k8s备份还原与集群迁移实战" tabindex="-1">利用Velero对K8S备份还原与集群迁移实战 <a class="header-anchor" href="#利用velero对k8s备份还原与集群迁移实战" aria-label="Permalink to &quot;利用Velero对K8S备份还原与集群迁移实战&quot;">​</a></h1><h2 id="简介" tabindex="-1">简介 <a class="header-anchor" href="#简介" aria-label="Permalink to &quot;简介&quot;">​</a></h2><p>Velero 是一款云原生时代的灾难恢复和迁移工具，采用 Go 语言编写，并在 github 上进行了开源，利用 velero 用户可以安全的备份、恢复和迁移 Kubernetes 集群资源和持久卷。</p><ul><li>开源地址：<a href="https://github.com/vmware-tanzu/velero" target="_blank" rel="noreferrer">https://github.com/vmware-tanzu/velero</a></li><li>官方文档：<a href="https://velero.io/docs/main/" target="_blank" rel="noreferrer">https://velero.io/docs/main/</a></li></ul><h3 id="velero组件" tabindex="-1">Velero组件 <a class="header-anchor" href="#velero组件" aria-label="Permalink to &quot;Velero组件&quot;">​</a></h3><p>Velero 组件一共分两部分，分别是服务端和客户端。</p><ul><li>服务端：运行在你 Kubernetes 的集群中</li><li>客户端：是一些运行在本地的命令行的工具，需要已配置好 <code>kubectl</code> 及集群 kubeconfig 的机器上</li></ul><h3 id="velero备份流程" tabindex="-1">Velero备份流程 <a class="header-anchor" href="#velero备份流程" aria-label="Permalink to &quot;Velero备份流程&quot;">​</a></h3><ul><li>velero客户端调用kubernetes API Server创建backup任务</li><li>Backup控制器基于watch机制通过Api Server获取到备份任务</li><li>Backup控制器开始执行备份动作，会通过请求Api Server获取到需要备份的数据</li><li>Backup 控制器将获取到的数据备份到指定的对象存储server端</li></ul><p><img src="https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/velero-workflow.png" alt="" loading="lazy"></p><h3 id="velero后端存储" tabindex="-1">Velero后端存储 <a class="header-anchor" href="#velero后端存储" aria-label="Permalink to &quot;Velero后端存储&quot;">​</a></h3><p>Velero支持两种关于后端存储的CRD，分别是<code>BackupStorageLocation</code>和<code>VolumeSnapshotLocation</code>。</p><h4 id="backupstoragelocation" tabindex="-1">BackupStorageLocation <a class="header-anchor" href="#backupstoragelocation" aria-label="Permalink to &quot;BackupStorageLocation&quot;">​</a></h4><p>主要用来定义 Kubernetes 集群资源的数据存放位置，也就是集群对象数据，不是 PVC 的数据。主要支持的后端存储是 S3 兼容的存储，比如：Mino 和阿里云 OSS 等。</p><h4 id="volumesnapshotlocation" tabindex="-1">VolumeSnapshotLocation <a class="header-anchor" href="#volumesnapshotlocation" aria-label="Permalink to &quot;VolumeSnapshotLocation&quot;">​</a></h4><p>主要用来给 PV 做快照，需要云提供商提供插件。阿里云已经提供了插件，这个需要使用 CSI 等存储机制。你也可以使用专门的备份工具 Restic，把 PV 数据备份到阿里云 OSS 中去(安装时需要自定义选项)。</p><p>Restic 是一款 GO 语言开发的数据加密备份工具，顾名思义，可以将本地数据加密后传输到指定的仓库。支持的仓库有 Local、SFTP、Aws S3、Minio、OpenStack Swift、Backblaze B2、Azure BS、Google Cloud storage、Rest Server。</p><h2 id="准备存储插件" tabindex="-1">准备存储插件 <a class="header-anchor" href="#准备存储插件" aria-label="Permalink to &quot;准备存储插件&quot;">​</a></h2><p>Velero支持很多种存储插件，可查看：<a href="https://velero.io/docs/main/supported-providers/" target="_blank" rel="noreferrer">https://velero.io/docs/main/supported-providers/</a> 获取插件信息，我们这里使用minio作为S3兼容的对象存储提供程序。您也可以在任意地方部署Minio对象存储，只需要保证K8S集群可以访问到即可。</p><h3 id="准备minio清单" tabindex="-1">准备minio清单 <a class="header-anchor" href="#准备minio清单" aria-label="Permalink to &quot;准备minio清单&quot;">​</a></h3><details class="details custom-block"><summary><code>minio.yaml</code></summary><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Service</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minio</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  namespace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">velero</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  labels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minio</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  selector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minio</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">api</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9000</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    protocol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TCP</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">console</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9001</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    protocol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TCP</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">---</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">apps/v1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">StatefulSet</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minio</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  namespace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">velero</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  labels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minio</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  replicas</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  serviceName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minio</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  selector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    matchLabels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minio</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      labels</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minio</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      containers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">minio</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">docker.io/bitnami/minio:2023.3.22</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        imagePullPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">IfNotPresent</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">containerPort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9000</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">api</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          protocol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TCP</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">containerPort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9001</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">console</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          protocol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TCP</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MINIO_ROOT_USER</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;minio&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MINIO_ROOT_PASSWORD</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;minio123&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MINIO_DEFAULT_BUCKETS</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;velero&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        volumeMounts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">data</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          mountPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/data</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  volumeClaimTemplates</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">data</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      spec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        accessModes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ReadWriteOnce&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        resources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          requests</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">            storage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">50Gi</span></span></code></pre></div></details><h3 id="创建minio应用" tabindex="-1">创建minio应用 <a class="header-anchor" href="#创建minio应用" aria-label="Permalink to &quot;创建minio应用&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建velero命名空间</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建minio资源</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio.yaml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看部署状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sts,pod,svc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                     READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">statefulset.apps/minio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     66s</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    RESTARTS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pod/minio-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          65s</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        CLUSTER-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      EXTERNAL-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   PORT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">S</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)             </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/minio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.99.223.162</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        9000/TCP,9001/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   66s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 开放NodePort端口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> patch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> svc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{&quot;spec&quot;: {&quot;type&quot;: &quot;NodePort&quot;}}&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> patch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> svc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --type=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;json&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/ports/0/nodePort&quot;, &quot;value&quot;:9000},{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/ports/1/nodePort&quot;, &quot;value&quot;:9001}]&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> svc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       CLUSTER-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      EXTERNAL-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   PORT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">S</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                       </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">minio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   NodePort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.99.223.162</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        9000:9000/TCP,9001:9001/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   140m</span></span></code></pre></div><p>通过浏览器访问服务器<code>IP:9001</code>，并使用账号<code>minio</code>密码<code>minio123</code>登入验证。</p><p><img src="https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/velero-practice-1.png" alt="" loading="lazy"></p><h2 id="安装velero" tabindex="-1">安装velero <a class="header-anchor" href="#安装velero" aria-label="Permalink to &quot;安装velero&quot;">​</a></h2><p>版本列表：<a href="https://github.com/vmware-tanzu/velero/releases" target="_blank" rel="noreferrer">https://github.com/vmware-tanzu/velero/releases</a></p><h3 id="安装velero命令程序" tabindex="-1">安装velero命令程序 <a class="header-anchor" href="#安装velero命令程序" aria-label="Permalink to &quot;安装velero命令程序&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/vmware-tanzu/velero/releases/download/v1.13.0/velero-v1.13.0-linux-amd64.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zxf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero-v1.13.0-linux-amd64.tar.gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero-v1.13.0-linux-amd64/velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/bin/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启用命令补全</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> completion bash)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> completion</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/bash_completion.d/velero</span></span></code></pre></div><h3 id="创建密钥" tabindex="-1">创建密钥 <a class="header-anchor" href="#创建密钥" aria-label="Permalink to &quot;创建密钥&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> credentials-velero</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[default]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">aws_access_key_id = minio</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">aws_secret_access_key = minio123</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span></code></pre></div><h3 id="安装velero到k8s集群" tabindex="-1">安装velero到k8s集群 <a class="header-anchor" href="#安装velero到k8s集群" aria-label="Permalink to &quot;安装velero到k8s集群&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --provider</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aws</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --image</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero/velero:v1.13.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --plugins</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero/velero-plugin-for-aws:v1.6.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bucket</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --secret-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./credentials-velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --use-node-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --use-volume-snapshots=false</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --backup-location-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> region=minio,s3ForcePathStyle=&quot;true&quot;,s3Url=http://minio:9000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --wait</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 执行install命令后会创建一系列清单，包括CustomResourceDefinition、Namespace、Deployment等。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 可使用如下命令查看运行日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> deployment/velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看velero创建的api对象</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> api-versions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">velero.io/v1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看备份位置</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup-location</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      PROVIDER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   BUCKET/PREFIX</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   PHASE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       LAST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VALIDATED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  ACCESS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MODE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   DEFAULT</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   aws</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          Available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   2023-03-28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 15:45:30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0800</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ReadWrite</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     true</span></span></code></pre></div><p>选项说明：</p><ul><li><code>--kubeconfig</code>(可选)：指定kubeconfig认证文件，默认使用<code>.kube/config</code>；</li><li><code>--provider</code>：定义插件提供方；</li><li><code>--image</code>：定义运行velero的镜像，默认与velero客户端一致；</li><li><code>--plugins</code>：指定使用aws s3兼容的插件镜像；</li><li><code>--bucket</code>：指定对象存储Bucket桶名称；</li><li><code>--secret-file</code>：指定对象存储认证文件；</li><li><code>--use-node-agent</code>：创建Velero Node Agent守护进程，托管FSB模块；</li><li><code>--use-volume-snapshots</code>：是否启使用快照；</li><li><code>--namespace</code>：指定部署的<code>namespace</code>名称，默认为velero；</li><li><code>--backup-location-config</code>：指定对象存储地址信息；</li></ul><h3 id="卸载velero" tabindex="-1">卸载velero <a class="header-anchor" href="#卸载velero" aria-label="Permalink to &quot;卸载velero&quot;">​</a></h3><p>如果您想从集群中完全卸载Velero，则以下命令将删除由<code>velero install</code>创建的所有资源:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> delete</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> namespace/velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clusterrolebinding/velero</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> delete</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> crds</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> component=velero</span></span></code></pre></div><h2 id="备份与恢复" tabindex="-1">备份与恢复 <a class="header-anchor" href="#备份与恢复" aria-label="Permalink to &quot;备份与恢复&quot;">​</a></h2><p>备份命令：<code>velero create backup NAME [flags]</code></p><p>backup选项：</p><ul><li><code>--exclude-namespaces</code>: 要从备份中排除的名称空间</li><li><code>--exclude-resources</code>: 要从备份中排除的资源，如<code>storageclasses.storage.k8s.io</code></li><li><code>--include-cluster-resources</code> optionalBool[=true]: 包含集群资源类型</li><li><code>--include-namespaces</code>: 要包含在备份中的名称空间(默认&#39;*&#39;)</li><li><code>--include-resources</code>: 备份中要包括的资源</li><li><code>--labels</code>: 给这个备份加上标签</li><li><code>-o, --output</code>: 指定输出格式，支持<code>&#39;table&#39;</code>、<code>&#39;json&#39;</code>和<code>&#39;yaml&#39;</code>；</li><li><code>-l, --selector</code>: 对指定标签的资源进行备份</li><li><code>--snapshot-volumes</code> optionalBool[=true]: 对 PV 创建快照</li><li><code>--storage-location</code>: 指定备份的位置</li><li><code>--ttl</code>: 备份数据多久删掉</li><li><code>--volume-snapshot-locations</code>: 指定快照的位置，也就是哪一个公有云驱动</li></ul><h3 id="备份" tabindex="-1">备份 <a class="header-anchor" href="#备份" aria-label="Permalink to &quot;备份&quot;">​</a></h3><h4 id="使用官方案例创建测试应用" tabindex="-1">使用官方案例创建测试应用 <a class="header-anchor" href="#使用官方案例创建测试应用" aria-label="Permalink to &quot;使用官方案例创建测试应用&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> examples/nginx-app/base.yaml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">namespace/nginx-example</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> created</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/nginx-deployment</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> created</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/my-nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> created</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看资源清单</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-example</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                   READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    RESTARTS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pod/nginx-deployment-57d5dcb68-g42mk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          41s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pod/nginx-deployment-57d5dcb68-pcc6t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          41s</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           CLUSTER-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   EXTERNAL-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   PORT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">S</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)        </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/my-nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   LoadBalancer</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.96.0.31</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pendin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">g</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     80:27370/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   41s</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                               READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   UP-TO-DATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AVAILABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/nginx-deployment</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   2/2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           41s</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                         DESIRED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   CURRENT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replicaset.apps/nginx-deployment-57d5dcb68</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       41s</span></span></code></pre></div><h4 id="备份测试应用" tabindex="-1">备份测试应用 <a class="header-anchor" href="#备份测试应用" aria-label="Permalink to &quot;备份测试应用&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-backup</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --include-namespaces</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-example</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> request</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;nginx-backup&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> submitted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> successfully.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup describe nginx-backup`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup logs nginx-backup`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> more details.</span></span></code></pre></div><p>选项：</p><ul><li><code>--include-namespaces</code>：指定命名空间</li><li><code>--selector</code>：标签选择器，如<code>app=nginx</code></li></ul><h4 id="查看备份列表" tabindex="-1">查看备份列表 <a class="header-anchor" href="#查看备份列表" aria-label="Permalink to &quot;查看备份列表&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      ERRORS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   WARNINGS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   CREATED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                         EXPIRES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   STORAGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LOCATION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   SELECTOR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nginx-backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Completed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          2023-03-09</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 09:38:50</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0800</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   29d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看备份详细信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> describe</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-backup</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看备份日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-backup</span></span></code></pre></div><p>登入minio控制台查看备份内容</p><p><img src="https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/velero-practice-2.png" alt="" loading="lazy"></p><h4 id="定时备份指南" tabindex="-1">定时备份指南 <a class="header-anchor" href="#定时备份指南" aria-label="Permalink to &quot;定时备份指南&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用cron表达式备份</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> schedule</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-daily</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --schedule=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0 1 * * *&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --include-namespaces</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-example</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用一些非标准的速记 cron 表达式</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> schedule</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-daily</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --schedule=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@daily&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --include-namespaces</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-example</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 手动触发定时任务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --from-schedule</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-daily</span></span></code></pre></div><h3 id="恢复" tabindex="-1">恢复 <a class="header-anchor" href="#恢复" aria-label="Permalink to &quot;恢复&quot;">​</a></h3><h4 id="模拟灾难" tabindex="-1">模拟灾难 <a class="header-anchor" href="#模拟灾难" aria-label="Permalink to &quot;模拟灾难&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 删除nginx-example命名空间和资源</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> delete</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-example</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 检查是否删除</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-example</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">No</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resources</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> found</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-example</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> namespace.</span></span></code></pre></div><h4 id="恢复资源" tabindex="-1">恢复资源 <a class="header-anchor" href="#恢复资源" aria-label="Permalink to &quot;恢复资源&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      ERRORS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   WARNINGS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   CREATED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                         EXPIRES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   STORAGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LOCATION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   SELECTOR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nginx-backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Completed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          2023-03-09</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 09:38:50</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0800</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   29d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restore</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --from-backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-backup</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Restore</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> request</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;nginx-backup-20230309095025&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> submitted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> successfully.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restore describe nginx-backup-20230309095025`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restore logs nginx-backup-20230309095025`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> more details.</span></span></code></pre></div><h4 id="检查恢复的资源" tabindex="-1">检查恢复的资源 <a class="header-anchor" href="#检查恢复的资源" aria-label="Permalink to &quot;检查恢复的资源&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restore</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                          BACKUP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      STARTED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                         COMPLETED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                       ERRORS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   WARNINGS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   CREATED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                         SELECTOR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nginx-backup-20230309095025</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   nginx-backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Completed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   2023-03-09</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 09:50:25</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0800</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   2023-03-09</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 09:50:25</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0800</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CST</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          2023-03-09</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 09:50:25</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0800</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看详细信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restore</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> describe</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-backup-20230309095025</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 检查资源状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx-example</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                   READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    RESTARTS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pod/nginx-deployment-57d5dcb68-g42mk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          2m19s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pod/nginx-deployment-57d5dcb68-pcc6t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          2m19s</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           CLUSTER-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    EXTERNAL-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   PORT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">S</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)        </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/my-nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   LoadBalancer</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.96.0.204</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pendin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">g</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     80:31291/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   2m19s</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                               READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   UP-TO-DATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AVAILABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/nginx-deployment</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   2/2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           2m19s</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                         DESIRED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   CURRENT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">replicaset.apps/nginx-deployment-57d5dcb68</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">         2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       2m19s</span></span></code></pre></div><h2 id="项目迁移实战" tabindex="-1">项目迁移实战 <a class="header-anchor" href="#项目迁移实战" aria-label="Permalink to &quot;项目迁移实战&quot;">​</a></h2><h3 id="项目介绍" tabindex="-1">项目介绍 <a class="header-anchor" href="#项目介绍" aria-label="Permalink to &quot;项目介绍&quot;">​</a></h3><p>我们将使用Velero快速完成云原生应用及PV数据的迁移实践过程，在本文示例中，我们将A集群中的一个MOS应用迁移到集群B中，其中数据备份采用自建Minio对象存储服务。</p><p><img src="https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/velero-practice-3.png" alt="" loading="lazy"></p><h4 id="环境要求" tabindex="-1">环境要求 <a class="header-anchor" href="#环境要求" aria-label="Permalink to &quot;环境要求&quot;">​</a></h4><ul><li>迁移项目最好保证两个Kubernetes集群版本一致。</li><li>为了保证PV数据成功迁移，两边需要安装好相同名字的StorageClass。</li><li>可以自己部署Minio，也可以使用公有云的对象存储服务，如华为的OBS、阿里的OSS等。</li><li>本案例将集群A中<code>app-system</code>命名空间中的服务及PV数据迁移到集群B中。</li></ul><h4 id="项目环境" tabindex="-1">项目环境 <a class="header-anchor" href="#项目环境" aria-label="Permalink to &quot;项目环境&quot;">​</a></h4><table><thead><tr><th>角色</th><th>集群IP</th><th>集群版本</th><th>部署软件</th></tr></thead><tbody><tr><td>K8S 集群A</td><td>192.168.1.102</td><td>v1.22.10</td><td><code>openebs、velero、app-system</code></td></tr><tr><td>K8S 集群B</td><td>192.168.1.103</td><td>v1.22.10</td><td><code>openebs、velero、minio</code></td></tr></tbody></table><h4 id="项目说明" tabindex="-1">项目说明 <a class="header-anchor" href="#项目说明" aria-label="Permalink to &quot;项目说明&quot;">​</a></h4><p>我们需要将集群A中 <code>app-system</code> 空间的所有资源和数据全部迁移到集群B中，该项目包括了<code>deployment、statefulset、service、ingress、job、cronjob、secret、configmap、pv、pvc</code>。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 项目清单信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> deployment,sts,pvc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app-system</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   UP-TO-DATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AVAILABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/hasura-graphql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/iot-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/iot-gateway</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/iot-history</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/iot-observer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/app-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/app-frontend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           5h27m</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">statefulset.apps/minio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">statefulset.apps/mongo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">statefulset.apps/postgres</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">statefulset.apps/rabbitmq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">statefulset.apps/redis</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     5h27m</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                       STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   VOLUME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                     CAPACITY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ACCESS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MODES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   STORAGECLASS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">persistentvolumeclaim/data-minio-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         Bound</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    pvc-950d15a8-20a5-4e5f-8dbf-b904295355bb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   50Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            openebs-hostpath</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">persistentvolumeclaim/data-mongo-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         Bound</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    pvc-e435b80e-0370-4100-b223-ca841f24bd5d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   50Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            openebs-hostpath</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">persistentvolumeclaim/data-postgres-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      Bound</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    pvc-359ec32a-4bfc-4bc8-8cf3-38322e8ef59b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   300Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            openebs-hostpath</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">persistentvolumeclaim/data-redis-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         Bound</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    pvc-da718e0c-992c-4f6e-af44-abb1c7214a9e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   2Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            openebs-hostpath</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   5h27m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">persistentvolumeclaim/app-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          Bound</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    pvc-506261a9-6be4-4d95-8807-58201e31a527</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   10Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            openebs-hostpath</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   5h27m</span></span></code></pre></div><h3 id="准备对象存储" tabindex="-1">准备对象存储 <a class="header-anchor" href="#准备对象存储" aria-label="Permalink to &quot;准备对象存储&quot;">​</a></h3><p>按照2.1和2.2的方法在集群B（<code>192.168.1.103</code>）中创建minio应用，用来存放备份数据。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sts,svc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                     READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">statefulset.apps/minio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     3h44m</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       CLUSTER-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      EXTERNAL-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   PORT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">S</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                       </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/minio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   NodePort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.99.223.162</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        9000:9000/TCP,9001:9001/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   3h44m</span></span></code></pre></div><h3 id="安装velero-1" tabindex="-1">安装velero <a class="header-anchor" href="#安装velero-1" aria-label="Permalink to &quot;安装velero&quot;">​</a></h3><p>请确保在集群A和集群B中已经安装好velero客户端，请参考<a href="./intro-and-practice.html#安装velero">安装velero命令程序</a></p><h4 id="在集群a中安装velero服务" tabindex="-1">在集群A中安装velero服务 <a class="header-anchor" href="#在集群a中安装velero服务" aria-label="Permalink to &quot;在集群A中安装velero服务&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> credentials-velero</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[default]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">aws_access_key_id = minio</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">aws_secret_access_key = minio123</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --provider</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aws</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --image</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero/velero:v1.13.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --plugins</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero/velero-plugin-for-aws:v1.6.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bucket</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --secret-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./credentials-velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --use-node-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --use-volume-snapshots=false</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --backup-location-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> region=minio,s3ForcePathStyle=&quot;true&quot;,s3Url=http://192.168.1.103:9000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --wait</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">注意📢：</p><p>其中S3的地址指向集群B（<code>192.168.1.103</code>）的minio对象存储。</p></div><h4 id="在集群b种安装velero服务" tabindex="-1">在集群B种安装velero服务 <a class="header-anchor" href="#在集群b种安装velero服务" aria-label="Permalink to &quot;在集群B种安装velero服务&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> credentials-velero</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[default]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">aws_access_key_id = minio</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">aws_secret_access_key = minio123</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --provider</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aws</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --image</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero/velero:v1.13.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --plugins</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero/velero-plugin-for-aws:v1.6.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bucket</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --secret-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./credentials-velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --use-node-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --use-volume-snapshots=false</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --backup-location-config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> region=minio,s3ForcePathStyle=&quot;true&quot;,s3Url=http://minio:9000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --wait</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">注意📢：</p><p>其中S3的地址指向本集群minio对象存储的svc地址。</p></div><h3 id="备份mos项目" tabindex="-1">备份MOS项目 <a class="header-anchor" href="#备份mos项目" aria-label="Permalink to &quot;备份MOS项目&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app-backup</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --default-volumes-to-fs-backup</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --include-namespaces</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app-system</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> request</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;app-backup&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> submitted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> successfully.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup describe app-backup`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup logs app-backup`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> more details.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看备份状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      ERRORS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   WARNINGS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   CREATED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                         EXPIRES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   STORAGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LOCATION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   SELECTOR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app-backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Completed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          2023-03-28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 16:34:56</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0800</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   29d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><ul><li><code>--default-volumes-to-fs-backup</code>：默认将所有PV卷进行备份，详情查看官方文档。</li><li><code>--include-namespaces</code>：指定要备份的命名空间</li></ul><p>登入minio控制台上可以看到备份的文件：</p><p><img src="https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/velero-practice-4.png" alt="" loading="lazy"></p><h3 id="恢复到集群b" tabindex="-1">恢复到集群B <a class="header-anchor" href="#恢复到集群b" aria-label="Permalink to &quot;恢复到集群B&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 到集群B中查看备份资源</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      ERRORS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   WARNINGS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   CREATED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                         EXPIRES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   STORAGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LOCATION</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   SELECTOR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app-backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Completed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          2023-03-28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 16:41:55</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0800</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   29d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 执行恢复命令</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restore</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --from-backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app-backup</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Restore</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> request</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;app-backup-20230328164601&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> submitted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> successfully.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restore describe app-backup-20230328164601`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restore logs app-backup-20230328164601`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> more details.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看恢复任务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> velero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restore</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                        BACKUP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      STARTED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                         COMPLETED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                       ERRORS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   WARNINGS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   CREATED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                         SELECTOR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app-backup-20230328164601</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   app-backup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Completed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   2023-03-28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 16:46:01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0800</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   2023-03-28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 17:01:26</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0800</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CST</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         2023-03-28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 16:46:01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0800</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><h3 id="验证服务和数据" tabindex="-1">验证服务和数据 <a class="header-anchor" href="#验证服务和数据" aria-label="Permalink to &quot;验证服务和数据&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> deploy,sts,svc,pvc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app-system</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   UP-TO-DATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AVAILABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/hasura-graphql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/iot-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/iot-gateway</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/iot-history</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/iot-observer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/app-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployment.apps/app-frontend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        1/1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           29m</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                READY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">statefulset.apps/minio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">statefulset.apps/mongo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">statefulset.apps/postgres</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">statefulset.apps/rabbitmq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">statefulset.apps/redis</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     29m</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                        TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        CLUSTER-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       EXTERNAL-IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   PORT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">S</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                               </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/hasura-graphql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.107.231.148</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        8080/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                              29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/iot-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.98.78.23</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        3000/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                              29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/iot-gateway</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.108.211.114</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        1880/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                              29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/iot-history</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.98.217.234</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        3000/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                              29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/iot-observer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.105.75.200</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        3010/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                              29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/minio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.97.14.151</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        9000/TCP,9001/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                     29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/mongo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.97.212.84</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        27017/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                             29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/app-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.107.16.116</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        5959/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                              29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/app-frontend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.100.136.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        80/TCP,443/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                        29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/postgres</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.101.235.245</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        5432/TCP,9187/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                     29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/rabbitmq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.108.29.67</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">     &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        15672/TCP,5672/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">service/redis</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               ClusterIP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   10.101.105.81</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        6379/TCP,9121/TCP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                     29m</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                       STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   VOLUME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                     CAPACITY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ACCESS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MODES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   STORAGECLASS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">persistentvolumeclaim/data-minio-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         Bound</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    pvc-ca5c63bf-9aaa-4755-ad8f-35718f51decf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   50Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            openebs-hostpath</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">persistentvolumeclaim/data-mongo-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         Bound</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    pvc-03203801-e339-44ee-bfb4-b196808c7cc5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   50Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            openebs-hostpath</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">persistentvolumeclaim/data-postgres-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      Bound</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    pvc-e2f2593e-5869-420c-bd39-54ce01dfa63f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   300Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            openebs-hostpath</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">persistentvolumeclaim/data-redis-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         Bound</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    pvc-a8e4445c-c6b5-483b-8b18-9d650daf35cc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   2Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            openebs-hostpath</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   29m</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">persistentvolumeclaim/app-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          Bound</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    pvc-2b2f9747-a020-4a16-9975-2491457c4032</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   10Gi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       RWO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            openebs-hostpath</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   29m</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-58e86873 data-v-886971e7><!--[--><!--]--><div class="edit-info" data-v-886971e7><div class="edit-link" data-v-886971e7><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/hyperter96/tech-blog/tree/main/docs/posts/velero/intro-and-practice.md" target="_blank" rel="noreferrer" data-v-886971e7><!--[--><span class="vpi-square-pen edit-link-icon" data-v-886971e7></span> 去 GitHub 上编辑内容<!--]--></a></div><div class="last-updated" data-v-886971e7><p class="VPLastUpdated" data-v-886971e7 data-v-85727031>上次更新于: <time datetime="2025-02-04T16:03:21.000Z" data-v-85727031></time></p></div></div><!----></footer><!--[--><!--[--><!--[--><!--[--><!--]--><!----><!--]--><!--]--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"aboutme.md\":\"4Ef49wF2\",\"fun_catch-the-cat.md\":\"D_Zf1A63\",\"index.md\":\"XilPSb8B\",\"posts_ai_lora-parameter.md\":\"NT47yAQP\",\"posts_ai_reinforcement-lora-ft.md\":\"4DeIauSU\",\"posts_cilium_bgp-exercise-bird-cilium.md\":\"DaW5wsSX\",\"posts_cilium_cilium-gateway-api.md\":\"CQzXEAm2\",\"posts_cilium_cilium-intro.md\":\"BFXCx-UB\",\"posts_cilium_exercise-cluster-mesh.md\":\"w9ur2O8i\",\"posts_cilium_install-cluster-with-kubeovn.md\":\"DpRBB8Gl\",\"posts_cybersecurity_aml_analysis-network-traffic-characteristics.md\":\"BZnOpRP5\",\"posts_cybersecurity_aml_keda-rule-infra.md\":\"Bd9lV5KI\",\"posts_cybersecurity_aml_rule-based.md\":\"niASGCfw\",\"posts_dragonfly_dragonfly-intro.md\":\"CeLAWQPa\",\"posts_dragonfly_exercise-dragonfly-with-nydus.md\":\"Bht0XBkX\",\"posts_interview_tcp-基础认识.md\":\"p7MkcTQq\",\"posts_interview_tcp.md\":\"-Bj1vp4r\",\"posts_jaeger_exercise-jaeger-in-prod.md\":\"XLGn-nwq\",\"posts_jaeger_jaeger-in-gin-and-grpc.md\":\"C1Pr1Mi9\",\"posts_kubeovn_kubeovn-intro.md\":\"DO0j99iT\",\"posts_kubeovn_vpc-nat-gateway-config.md\":\"Bt021V_Y\",\"posts_kubevela_addon-build-instruction.md\":\"DPTSwKHC\",\"posts_kubevela_application-controller-source-code-analysis-1.md\":\"9GJdP7uL\",\"posts_kubevela_application-controller-source-code-analysis-2.md\":\"QOzCS5uL\",\"posts_kubevela_get-to-know-kubevela.md\":\"Dh_6vWhU\",\"posts_kubevela_kubevela-integrate-multicluster-with-ocm.md\":\"yYi5LDli\",\"posts_kubevirt_hotplug-interface.md\":\"COYwkz42\",\"posts_kubevirt_quick-deploy-centos7.md\":\"D_Cvkofb\",\"posts_learning-path.md\":\"DxoMwNd-\",\"posts_linux_centos7-upgrade-to-stream9.md\":\"CvAkB9t0\",\"posts_linux_install-vm-centos-stream9.md\":\"C2foQ4OK\",\"posts_mysql_mysql-index.md\":\"Cw8vnO8Y\",\"posts_mysql_mysql-infra.md\":\"BPVgDVsm\",\"posts_programming_go_array-and-slices.md\":\"DGSMrQCk\",\"posts_programming_go_channel.md\":\"B5jA-AxE\",\"posts_programming_go_client-go_api-machinery.md\":\"BiSqweBA\",\"posts_programming_go_client-go_client-go-pkg-part1.md\":\"pITooxor\",\"posts_programming_go_client-go_client-go-pkg-part2.md\":\"CyNCRL0g\",\"posts_programming_go_client-go_clientset.md\":\"C-hw3jKl\",\"posts_programming_go_client-go_informer-exercise.md\":\"D3vWPXRM\",\"posts_programming_go_client-go_informer.md\":\"Bvgk7Cwl\",\"posts_programming_go_client-go_intro.md\":\"Hiz8Fi5Y\",\"posts_programming_go_defer.md\":\"CxyvQm--\",\"posts_programming_go_goroutine.md\":\"Dfcs5Jaq\",\"posts_programming_go_interface.md\":\"C8ALTrPt\",\"posts_programming_go_mutex.md\":\"nVNsOKqj\",\"posts_programming_go_waitgroup.md\":\"FoniHm0_\",\"posts_programming_rust_borrowing.md\":\"BEWhqy6H\",\"posts_programming_rust_disable-warning.md\":\"D7rJiKbC\",\"posts_programming_rust_fundamental-type.md\":\"TYbKGZnG\",\"posts_programming_rust_get-to-know-cargo.md\":\"Bl7X2Ax0\",\"posts_programming_rust_ownership.md\":\"DNDNWdc3\",\"posts_programming_rust_rust-function.md\":\"D_HHsBJl\",\"posts_programming_rust_statement-expr-print.md\":\"CZCuKwR2\",\"posts_programming_rust_types-system.md\":\"DfznwlAl\",\"posts_programming_rust_variable-bindings.md\":\"B9cwWV5W\",\"posts_programming_webassembly_run-wasm-app-from-host.md\":\"CqQcioJw\",\"posts_programming_webassembly_webassembly-full-stack-app.md\":\"DAYtku1K\",\"posts_troubleshooting_k8s-pod-abnormal-analysis.md\":\"Cbds-bX0\",\"posts_velero_intro-and-practice.md\":\"Cv-O3FKW\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"皮特ᴾᵗ的博客技术站\",\"description\":\"热衷于网络安全、云原生技术，一直为实现自我价值而执着！\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"blog\":{\"pagesData\":[{\"route\":\"/aboutme\",\"meta\":{\"sidebar\":false,\"title\":\"关于自己\",\"date\":\"2021-11-13 00:00:00\",\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/lighthouse.jpg\",\"tags\":[\"其它\"],\"tag\":[\"其它\"],\"description\":\"关于我\\n---\\n96年出生，标准的理工男一枚,毕业于(加拿大滑铁卢大学),热爱开源与知识分享~\\n除了技术，本人也是对心理学有浓厚的兴趣，热衷于研究mbti，希望可以多一点了解自己还有身边的人，理解为人\"}},{\"route\":\"/fun/catch-the-cat\",\"meta\":{\"date\":\"2021-02-02 03:04:49\",\"draft\":false,\"title\":\"逮住那只猫！\",\"sidebar\":false,\"tags\":[\"其它\"],\"tag\":[\"其它\"],\"description\":\"游戏规则\\n1. 点击小圆点，围住小猫。\\n2. 你点击一次，小猫走一次。\\n3. 直到你把小猫围住（赢），或者小猫走到边界并逃跑（输）。\\n---\\n&lt;div align=\\\"center\\\"\\n    &l\",\"cover\":\"\"}},{\"route\":\"/posts/learning-path\",\"meta\":{\"sidebar\":false,\"date\":\"2021-03-05 00:00:00\",\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/background7.jpeg\",\"tags\":[\"其它\"],\"title\":\"关于研究技术的思维和规划\",\"tag\":[\"其它\"],\"description\":\"关于研究技术的思维和规划\\n 研究技术的思维\\n 研究每项技术的意义\\n当我每次研究一项新的技术的时候，我都会思考这项技术的意义：\\n- 这项技术的发展背景\\n- 为什么要发展这项技术？有什么好处？\\n- 这项技\"}},{\"route\":\"/posts/ai/lora-parameter\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/background2.jpg\",\"date\":\"2025-02-03 00:00:00\",\"tag\":[\"AI\",\"人工智能\",\"强化学习\",\"Fine Tuning\"],\"sticky\":1,\"prev\":{\"link\":\"/posts/ai/reinforcement-lora-ft\",\"text\":\"通过强化学习实现反馈优化层的自动 LoRA 微调\"},\"title\":\"LoRA微调的参数对训练模型的作用和影响\",\"description\":\"LoRA微调核心参数清单\\n|参数名|典型值范围|作用|对模型的影响|\\n|------|----------|----|------------|\\n|秩 (rank, $r$)|`2~64`|控制低秩矩\"}},{\"route\":\"/posts/ai/reinforcement-lora-ft\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/background2.jpg\",\"date\":\"2025-02-02 00:00:00\",\"tag\":[\"AI\",\"人工智能\",\"强化学习\",\"Fine Tuning\"],\"sticky\":1,\"next\":{\"link\":\"/posts/ai/lora-parameter\",\"text\":\"LoRA微调的参数对训练模型的作用和影响\"},\"title\":\"通过强化学习实现反馈优化层的自动 LoRA 微调\",\"description\":\"通过强化学习实现反馈优化层的自动 LoRA 微调\\n要实现基于强化学习（RL）的自动 LoRA（Low-Rank Adaptation）微调，需将模型微调过程转化为策略优化问题，通过动态奖励机制引导模型\"}},{\"route\":\"/posts/cilium/bgp-exercise-bird-cilium\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/cilium-bgp-demo.svg\",\"date\":\"2024-02-05 00:00:00\",\"tag\":[\"Cilium\",\"网络\",\"cni\",\"kubernetes\"],\"sticky\":1,\"prev\":{\"text\":\"Cilium系列一：Cilium架构体系\",\"link\":\"/posts/cilium/cilium-intro\"},\"next\":{\"text\":\"Cilium系列三：Cilium在集群网格Cluster Mesh中的实践\",\"link\":\"/posts/cilium/exercise-cluster-mesh\"},\"title\":\"Cilium系列二：使用bird和cilium部署BGP模式的k8s集群\",\"description\":\"Cilium系列二：使用bird和cilium部署BGP模式的k8s集群\\n这是使用 Cilium BGP 控制平面 (BGP CP) 向外部 BGP 路由器通告路由以及在两个集群之间路由的演示。 每个\"}},{\"route\":\"/posts/cilium/cilium-gateway-api\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/kubernetes-gateway-api-cilium.jpg\",\"date\":\"2024-02-22 00:00:00\",\"tag\":[\"Cilium\",\"网络\",\"cni\",\"kubernetes\"],\"sticky\":1,\"prev\":{\"text\":\"Cilium系列四：Cilium集成kubeOVN安装k8s集群\",\"link\":\"/posts/cilium/install-cluster-with-kubeOVN\"},\"title\":\"Cilium系列五：Cilium集成Gateway API\",\"description\":\"Cilium系列五：Cilium集成Gateway API\\n 前置条件\\n- Cilium 必须配置为启用 NodePort，使用 `nodePort.enabled=true` 或使用 `kubePr\"}},{\"route\":\"/posts/cilium/cilium-intro\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cilium.io/static/620dc85c97b669d3417218f1602224df/905a7/intro.webp\",\"date\":\"2024-02-04 00:00:00\",\"tag\":[\"Cilium\",\"网络\",\"cni\",\"kubernetes\"],\"sticky\":1,\"next\":{\"text\":\"Cilium系列二：使用bird和cilium部署BGP模式的k8s集群\",\"link\":\"/posts/cilium/bgp-exercise-bird-cilium\"},\"title\":\"Cilium系列一：Cilium架构体系\",\"description\":\"Cilium系列一：Cilium架构体系\\nCilium 是一款开源软件，也是 CNCF 的孵化项目，目前已有公司提供商业化支持，还有基于 Cilium 实现的服务网格解决方案。最初它仅是作为一个 Ku\"}},{\"route\":\"/posts/cilium/exercise-cluster-mesh\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/cluster-mesh.png\",\"date\":\"2024-02-07 00:00:00\",\"tag\":[\"Cilium\",\"网络\",\"cni\",\"kubernetes\"],\"sticky\":1,\"prev\":{\"text\":\"Cilium系列二：使用bird和cilium部署BGP模式的k8s集群\",\"link\":\"/posts/cilium/bgp-exercise-bird-cilium\"},\"next\":{\"text\":\"Cilium系列四：Cilium集成kubeOVN安装k8s集群\",\"link\":\"/posts/cilium/install-cluster-with-kubeOVN\"},\"title\":\"Cilium系列三：Cilium在集群网格Cluster Mesh中的实践\",\"description\":\"Cilium系列三：Cilium在集群网格Cluster Mesh中的实践\\nCilium Cluster Mesh 允许您连接多个集群的网络，只要所有集群都运行 Cilium 作为其 CNI，每个集群\"}},{\"route\":\"/posts/cilium/install-cluster-with-kubeOVN\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/cilium-kubeOVN-cover.png\",\"date\":\"2024-02-20 00:00:00\",\"tag\":[\"Cilium\",\"网络\",\"cni\",\"kubernetes\"],\"sticky\":1,\"prev\":{\"text\":\"Cilium系列三：Cilium在集群网格Cluster Mesh中的实践\",\"link\":\"/posts/cilium/exercise-cluster-mesh\"},\"next\":{\"text\":\"Cilium系列五：Cilium集成Gateway API\",\"link\":\"/posts/cilium/cilium-gateway-api\"},\"title\":\"Cilium系列四：Cilium集成kubeOVN安装k8s集群\",\"description\":\"Cilium系列四：Cilium集成kubeOVN安装k8s集群\\n 前提条件\\n- helm\\n- sealos二进制cli\\n- kubeOVN的安装脚本`install.sh`\\n节点规划如下：\\n|角色|\"}},{\"route\":\"/posts/dragonfly/dragonfly-intro\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/dragonfly_cover.jpg\",\"date\":\"2024-01-07 00:00:00\",\"tag\":[\"P2P\",\"Dragonfly\",\"kubernetes\"],\"sticky\":1,\"next\":{\"text\":\"Dragonfly系列二：Dragonfly 和 Nydus Mirror 模式集成实践\",\"link\":\"/posts/dragonfly/exercise-dragonfly-with-nydus\"},\"title\":\"Dragonfly系列一：Dragonfly架构体系\",\"description\":\"Dragonfly系列一：Dragonfly架构体系\\nDragonfly是一个基于P2P的开源文件分发和图像加速系统。 它由云原生计算基金会 (CNCF) 作为孵化级项目托管。 其目标是解决云原生架构\"}},{\"route\":\"/posts/dragonfly/exercise-dragonfly-with-nydus\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/dragonfly_cover.jpg\",\"date\":\"2024-01-09 00:00:00\",\"tag\":[\"P2P\",\"Dragonfly\",\"kubernetes\"],\"sticky\":1,\"prev\":{\"text\":\"Dragonfly系列一：Dragonfly架构体系\",\"link\":\"/posts/dragonfly/dragonfly-intro\"},\"title\":\"Dragonfly系列二：Dragonfly 和 Nydus Mirror 模式集成实践\",\"description\":\"Dragonfly系列二：Dragonfly 和 Nydus Mirror 模式集成实践\\n`Nydus` 作为 `Dragonfly` 的子项目优化了 `OCIv1` 镜像格式，并以此设计了一个镜像文\"}},{\"route\":\"/posts/interview/tcp-基础认识\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/lazer.png\",\"author\":\"皮特ᴾᵗ\",\"date\":\"2024-02-10 00:00:00\",\"categories\":[\"TCP\",\"面试\"],\"prev\":{\"text\":\"面试系列之：TCP篇\",\"link\":\"/posts/interview/tcp\"},\"title\":\"面试系列之：TCP基础认识\",\"tag\":[\"TCP\",\"面试\"],\"description\":\"面试系列之：TCP基础认识\\n TCP 头格式有哪些？\\n我们先来看看 TCP 头的格式，标注颜色的表示与本文关联比较大的字段，其他字段不做详细阐述。\\n序列号：在建立连接时由计算机生成的随机数作为其初始值\"}},{\"route\":\"/posts/interview/tcp\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/lazer.png\",\"author\":\"皮特ᴾᵗ\",\"date\":\"2024-02-02 09:04:00\",\"categories\":[\"TCP\",\"面试\"],\"next\":{\"text\":\"面试系列之：TCP基础认识\",\"link\":\"/posts/interview/tcp-基础认识\"},\"title\":\"面试系列之：TCP篇\",\"tag\":[\"TCP\",\"面试\"],\"description\":\"面试系列之：TCP篇\\n 框架图\\n&lt;script setup\\n  import XmindViewer from '../../.vitepress/theme/components/XmindV\"}},{\"route\":\"/posts/jaeger/exercise-jaeger-in-prod\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/Jaeger-cover1.jpg\",\"date\":\"2023-05-11 00:00:00\",\"author\":\"意琦行\",\"tag\":[\"Jaeger\",\"分布式链路追踪\",\"kubernetes\"],\"sticky\":1,\"prev\":{\"text\":\"Jaeger系列一：Jaeger 在 gin 框架和 gRPC 中的使用\",\"link\":\"/posts/jaeger/jaeger-in-gin-and-grpc\"},\"title\":\"Jaeger系列二：Jaeger线上环境部署\",\"description\":\"Jaeger系列二：Jaeger线上环境部署\\n本文主要记录了如何在生产环境中部署Jaeger各个组件，包括 `Agent`、`Collector`、`Query`、`Storage` 等等。\\n  概述\"}},{\"route\":\"/posts/jaeger/jaeger-in-gin-and-grpc\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/Jaeger-cover1.jpg\",\"date\":\"2023-05-04 00:00:00\",\"author\":\"意琦行\",\"tag\":[\"Jaeger\",\"分布式链路追踪\",\"kubernetes\"],\"sticky\":1,\"next\":{\"text\":\"Jaeger系列二：Jaeger线上环境部署\",\"link\":\"/posts/jaeger/exercise-jaeger-in-prod\"},\"title\":\"Jaeger系列一：Jaeger 在 gin 框架和 gRPC 中的使用\",\"description\":\"Jaeger系列一：Jaeger 在 gin 框架和 gRPC 中的使用\\n本文通过简单的例子记录了如何在 gin 框架和 gRPC 中使用 Jaeger 进行链路追踪。\\n `Gin`\\n通过 `Midd\"}},{\"route\":\"/posts/kubeOVN/kubeOVN-intro\",\"meta\":{\"sidebar\":false,\"date\":\"2023-12-11 00:00:00\",\"tag\":[\"KubeOVN\",\"网络\",\"cni\",\"SDN\",\"kubernetes\"],\"sticky\":1,\"next\":{\"text\":\"KubeOVN系列二：配置VPC网关连通外部公网\",\"link\":\"/posts/kubeOVN/vpc-nat-gateway-config\"},\"title\":\"KubeOVN系列一：KubeOVN架构体系\",\"description\":\"KubeOVN系列一：KubeOVN架构体系\\n总体来看，Kube-OVN 作为 Kubernetes 和 OVN 之间的一个桥梁，将成熟的 SDN 和云原生相结合。 这意味着 Kube-OVN 不仅通\",\"cover\":\"https://kubeovn.github.io/docs/v1.12.x/static/architecture.png\"}},{\"route\":\"/posts/kubeOVN/vpc-nat-gateway-config\",\"meta\":{\"sidebar\":false,\"date\":\"2023-12-13 00:00:00\",\"tag\":[\"KubeOVN\",\"网络\",\"cni\",\"SDN\",\"kubernetes\"],\"sticky\":1,\"prev\":{\"text\":\"KubeOVN系列一：KubeOVN架构体系\",\"link\":\"/posts/kubeOVN/kubeOVN-intro\"},\"title\":\"KubeOVN系列二：配置VPC网关连通外部公网\",\"description\":\"KubeOVN系列二：配置VPC网关连通外部公网\\nKube-OVN 支持多租户隔离级别的 VPC 网络。不同 VPC 网络相互独立，可以分别配置 Subnet 网段， 路由策略，安全策略，出网网关，E\",\"cover\":\"https://kubeovn.github.io/docs/v1.12.x/static/network-topology.png\"}},{\"route\":\"/posts/kubevela/addon-build-instruction\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/background4.jpeg\",\"date\":\"2023-10-18 00:00:00\",\"author\":\"姜洪烨\",\"tag\":[\"Kubevela\",\"应用交付\",\"kubernetes\"],\"sticky\":1,\"prev\":{\"text\":\"Kubevela系列三：Application Controller 源码分析(下)\",\"link\":\"/posts/kubevela/application-controller-source-code-analysis-2\"},\"next\":{\"text\":\"Kubevela系列五：Kubevela集成多集群OCM\",\"link\":\"/posts/kubevela/kubevela-integrate-multicluster-ocm\"},\"title\":\"Kubevela系列四：插件指南-轻松扩展你的平台专属能力\",\"description\":\"Kubevela系列四：插件指南-轻松扩展你的平台专属能力\\nKubeVela 插件（addon）可以方便地扩展 KubeVela 的能力。正如我们所知，KubeVela 是一个微内核高度可扩展的平台，\"}},{\"route\":\"/posts/kubevela/application-controller-source-code-analysis-1\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/k8s-1.jpeg\",\"date\":\"2023-09-22 00:00:00\",\"author\":\"意琦行\",\"tag\":[\"Kubevela\",\"应用交付\",\"kubernetes\"],\"sticky\":1,\"prev\":{\"text\":\"Kubevela系列一：初识 KubeVela，基于 OAM 模型的应用交付平台\",\"link\":\"/posts/kubevela/get-to-know-kubevela\"},\"next\":{\"text\":\"Kubevela系列三：Application Controller 源码分析(下)\",\"link\":\"/posts/kubevela/application-controller-source-code-analysis-2\"},\"title\":\"Kubevela系列二：Application Controller 源码分析(上)\",\"description\":\"Kubevela系列二：Application Controller 源码分析(上)\\n本文主要分析 KubeVela 中的 App Controller 部分源码，分享 app 对象 apply 到集\"}},{\"route\":\"/posts/kubevela/application-controller-source-code-analysis-2\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/k8s-2.jpeg\",\"date\":\"2023-09-23 00:00:00\",\"author\":\"意琦行\",\"tag\":[\"Kubevela\",\"应用交付\",\"kubernetes\"],\"sticky\":1,\"prev\":{\"text\":\"Kubevela系列二：Application Controller 源码分析(上)\",\"link\":\"/posts/kubevela/application-controller-source-code-analysis-1\"},\"next\":{\"text\":\"Kubevela系列四：插件指南-轻松扩展你的平台专属能力\",\"link\":\"/posts/kubevela/addon-build-instruction\"},\"title\":\"Kubevela系列三：Application Controller 源码分析(下)\",\"description\":\"Kubevela系列三：Application Controller 源码分析(下)\\n本文主要分析 KubeVela 中的 App Controller 部分源码，分享 app 对象 apply 到集\"}},{\"route\":\"/posts/kubevela/get-to-know-kubevela\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/kubevela-cover1-application.png\",\"date\":\"2023-09-09 00:00:00\",\"author\":\"意琦行\",\"tag\":[\"Kubevela\",\"应用交付\",\"kubernetes\"],\"sticky\":1,\"next\":{\"text\":\"Kubevela系列二：Application Controller 源码分析(上)\",\"link\":\"/posts/kubevela/application-controller-source-code-analysis-1\"},\"title\":\"Kubevela系列一：初识 KubeVela，基于 OAM 模型的应用交付平台\",\"description\":\"Kubevela系列一：初识 KubeVela，基于 OAM 模型的应用交付平台\\n本文主要介绍了 KubeVela 是什么，解决了什么问题，以及如何解决的。\\n Kubevela介绍\\n Kubevela\"}},{\"route\":\"/posts/kubevela/kubevela-integrate-multicluster-with-ocm\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/background6.jpeg\",\"date\":\"2023-10-20 00:00:00\",\"tag\":[\"Kubevela\",\"应用交付\",\"kubernetes\"],\"sticky\":1,\"prev\":{\"text\":\"Kubevela系列四：插件指南-轻松扩展你的平台专属能力\",\"link\":\"/posts/kubevela/addon-build-instruction\"},\"title\":\"Kubevela系列五：Kubevela集成多集群OCM\",\"description\":\"Kubevela系列五：Kubevela集成多集群OCM\\n本章节将会介绍如何使用 KubeVela 分发多集群应用。\\n 简介\\n如今，在越来越多的场景下，开发者和系统运维人员开始将应用部署在多个集群中：\"}},{\"route\":\"/posts/kubevirt/hotplug-interface\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/background2.jpg\",\"date\":\"2023-10-03 00:00:00\",\"tag\":[\"Kubevirt\",\"虚拟机\",\"kubernetes\"],\"sticky\":1,\"prev\":{\"text\":\"Kubevirt系列一：虚拟机CentOS 7部署实践\",\"link\":\"/posts/kubevirt/quick-deploy-centos7\"},\"title\":\"Kubevirt系列二：虚拟机网卡热插拔\",\"description\":\"Kubevirt系列二：虚拟机网卡热插拔\\n 设计动机\\n向正在运行的虚拟机热插拔/热拔出（添加/删除）NIC 是可用于多个平台的行业标准，允许动态连接 L2 网络。 当工作负载 (VM) 在连接/删除网\"}},{\"route\":\"/posts/kubevirt/quick-deploy-centos7\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/aliyun-image-source.png\",\"date\":\"2023-10-01 00:00:00\",\"tag\":[\"Kubevirt\",\"虚拟机\",\"kubernetes\"],\"sticky\":1,\"next\":{\"text\":\"Kubevirt系列二：虚拟机网卡热插拔\",\"link\":\"/posts/kubevirt/hotplug-interface\"},\"title\":\"Kubevirt系列一：虚拟机CentOS 7部署实践\",\"description\":\"Kubevirt系列一：虚拟机CentOS 7部署实践\\n俗话说，实践是检验真理的唯一标准，不妨让我们尝试用kubeVirt部署一台属于自己的虚拟机吧~\\n 准备环境\\n首先，我们需要安装`libvirt`\"}},{\"route\":\"/posts/linux/centos7-upgrade-to-stream9\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/algorithm-1.jpeg\",\"date\":\"2024-02-01 00:00:00\",\"tag\":[\"虚拟机\",\"linux\"],\"title\":\"CentOS 7 升级至 CentOS Stream 9 操作教程\",\"description\":\"CentOS 7 升级至 CentOS Stream 9 操作教程\\n本操作教程仓库地址：https://github.com/hyperter96/OhMyStream9，所有Shell脚本在`scr\"}},{\"route\":\"/posts/linux/install-vm-centos-stream9\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/algorithm-1.jpeg\",\"date\":\"2024-02-07 00:00:00\",\"tag\":[\"虚拟机\",\"linux\"],\"title\":\"VMware安装CentOS Stream 9\",\"description\":\"VMware安装CentOS Stream 9\\n 下载Linux镜像\\n下载地址：centos-stream-9-stream-BaseOS-x86_64-iso安装包下载_开源镜像站-阿里云 (ali\"}},{\"route\":\"/posts/mysql/mysql-index\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/mysql-cover.jpg\",\"date\":\"2024-05-05 00:00:00\",\"sticky\":1,\"tags\":[\"kubernetes\",\"MySQL\"],\"prev\":{\"text\":\"MySQL知识系列一：MySQL架构图\",\"link\":\"/posts/mysql/mysql-infra\"},\"title\":\"MySQL知识系列二：MySQL索引\",\"tag\":[\"kubernetes\",\"MySQL\"],\"description\":\"MySQL知识系列二：MySQL索引\\n存储引擎与底层实现的数据结构\\n     \\n数据结构 - 索引怎么选择合适的数据结构？中分析过能作为索引的数据结构主要有散列表（Hash表）、红黑树、跳表、B+树（\"}},{\"route\":\"/posts/mysql/mysql-infra\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/mysql-cover.jpg\",\"date\":\"2024-05-03 00:00:00\",\"sticky\":1,\"tags\":[\"kubernetes\",\"MySQL\"],\"next\":{\"text\":\"MySQL知识系列二：MySQL索引\",\"link\":\"/posts/mysql/mysql-index\"},\"title\":\"MySQL知识系列一：MySQL架构图\",\"tag\":[\"kubernetes\",\"MySQL\"],\"description\":\"MySQL知识系列一：MySQL架构图\\nMysql服务端架构分为Server层和存储引擎层（可插拔式），Server层主要包含了连接器、缓存模块、分析器、优化器、执行器；可插拔的存储引擎主要有Inno\"}},{\"route\":\"/posts/troubleshooting/k8s-pod-abnormal-analysis\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/k8s-2.jpeg\",\"categories\":[\"kubernetes\"],\"date\":\"2023-05-06 11:45:56\",\"tags\":[\"kubernetes\",\"故障分析\"],\"title\":\"K8S故障分析系列一：基于真实场景解读K8S_Pod的各种异常\",\"tag\":[\"kubernetes\",\"故障分析\"],\"description\":\"K8S故障分析系列一：基于真实场景解读K8S_Pod的各种异常\\n Pod 生命周期\\n在整个生命周期中，Pod 会出现 5 种阶段（Phase）。\\n- Pending：Pod 被 K8s 创建出来后，起\"}},{\"route\":\"/posts/velero/intro-and-practice\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/velero-cover.png\",\"date\":\"2024-01-05 00:00:00\",\"tag\":[\"Velero\",\"备份恢复\",\"kubernetes\"],\"sticky\":1,\"title\":\"利用Velero对K8S备份还原与集群迁移实战\",\"description\":\"利用Velero对K8S备份还原与集群迁移实战\\n 简介\\nVelero 是一款云原生时代的灾难恢复和迁移工具，采用 Go 语言编写，并在 github 上进行了开源，利用 velero 用户可以安全的备\"}},{\"route\":\"/posts/cyberSecurity/aml/analysis-network-traffic-characteristics\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/algorithm-1.jpeg\",\"date\":\"2024-12-22 00:00:00\",\"sticky\":1,\"tags\":[\"网络安全\",\"AML\"],\"prev\":{\"text\":\"基于KEDA事件驱动的AML规则引擎架构设计\",\"link\":\"/posts/cyberSecurity/keda-rule-infra\"},\"title\":\"基于 Weight of Evidence (WOE) 和 Information Value (IV) 的网络流量特征分析\",\"tag\":[\"网络安全\",\"AML\"],\"description\":\"基于 Weight of Evidence (WOE) 和 Information Value (IV) 的网络流量特征分析\\n基于 Weight of Evidence (WOE) 和 Informa\"}},{\"route\":\"/posts/cyberSecurity/aml/keda-rule-infra\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/algorithm-1.jpeg\",\"date\":\"2024-12-19 00:00:00\",\"sticky\":1,\"tags\":[\"网络安全\",\"AML\"],\"prev\":{\"text\":\"AML规则探索\",\"link\":\"/posts/cyberSecurity/rule-based\"},\"next\":{\"text\":\"基于WOE和IV的网络流量特征分析\",\"link\":\"/posts/cyberSecurity/analysis-network-traffic-characteristics\"},\"title\":\"基于KEDA事件驱动的AML规则引擎架构设计\",\"tag\":[\"网络安全\",\"AML\"],\"description\":\"基于KEDA事件驱动的AML规则引擎架构设计\\n KEDA事件驱动机制\\n使用 KEDA (Kubernetes Event-driven Autoscaling) 事件驱动机制来触发 AML (Anti\"}},{\"route\":\"/posts/cyberSecurity/aml/rule-based\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/algorithm-1.jpeg\",\"date\":\"2024-12-17 00:00:00\",\"sticky\":1,\"tags\":[\"网络安全\",\"AML\"],\"next\":{\"text\":\"AML规则引擎架构设计\",\"link\":\"/posts/cyberSecurity/keda-rule-infra\"},\"title\":\"AML规则探索\",\"tag\":[\"网络安全\",\"AML\"],\"description\":\"AML规则探索\\nAML规则引擎通过定义各种“规则”来监控交易，识别可疑活动，并触发相应的警报或调查。以下是一些关键的AML规则设计和策略，可用于检测常见的洗钱手段：\\n 交易金额和频率规则\\n 大额交易规\"}},{\"route\":\"/posts/programming/go/array-and-slices\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/go-cover1-slices.jpeg\",\"date\":\"2022-07-02 00:00:00\",\"tag\":[\"Go\",\"编程基础\"],\"sticky\":1,\"next\":{\"text\":\"Go 基础知识系列二: 协程\",\"link\":\"/posts/programming/go/goroutine\"},\"title\":\"Go 基础知识系列一: 数组与切片\",\"description\":\"Go 基础知识系列一: 数组与切片\\n这篇文章总结了 Go 的知识体系数组与切片，包括其中的底层实现等等。\\n:::warning 注意\\n说起 Golang， 大家都会第一时间想到高并发和 Golang \"}},{\"route\":\"/posts/programming/go/channel\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/go-cover1-slices.jpeg\",\"date\":\"2022-07-08 00:00:00\",\"tag\":[\"Go\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Go 基础知识系列四：接口interface\",\"link\":\"/posts/programming/go/interface\"},\"next\":{\"text\":\"Go 基础知识系列六：互斥锁mutex\",\"link\":\"/posts/programming/go/mutex\"},\"title\":\"Go 基础知识系列五：Channel\",\"description\":\"Go 基础知识系列五：Channel\\n 什么是 channel 管道\\n它是一个数据管道，可以往里面写数据，从里面读数据。\\nchannel 是 goroutine 之间数据通信桥梁，而且是线程安全的。\\n\"}},{\"route\":\"/posts/programming/go/defer\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/go-cover1-slices.jpeg\",\"date\":\"2022-07-13 00:00:00\",\"tag\":[\"Go\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Go 基础知识系列六：互斥锁mutex\",\"link\":\"/posts/programming/go/mutex\"},\"title\":\"Go 基础知识系列七：延迟函数调用Defer\",\"description\":\"Go 基础知识系列七：延迟函数调用Defer\\n`defer`语句用于延迟函数的调用，每次`defer`都会把一个函数压入栈中，函数返回前再把延迟的函数取出并执行。\\n为了方便描述，我们把创建`defer\"}},{\"route\":\"/posts/programming/go/goroutine\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/go-cover2-goroutine.jpeg\",\"date\":\"2022-07-03 00:00:00\",\"tag\":[\"Go\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Go 基础知识系列一: 数组与切片\",\"link\":\"/posts/programming/go/array-and-slices\"},\"next\":{\"text\":\"Go 基础知识系列三: 等待组waitGroup\",\"link\":\"/posts/programming/go/waitgroup\"},\"title\":\"Go 基础知识系列二: 协程\",\"description\":\"Go 基础知识系列二: 协程\\n这篇文章总结了 Go 的知识体系：协程，包括其中的底层实现等等。\\n 协程(coroutine)\\n在讲 goroutine 之前让我们先了解一下协程 (coroutine)\"}},{\"route\":\"/posts/programming/go/interface\",\"meta\":{\"sidebar\":false,\"cover\":\"https://hyper2t.github.io/interface/featured-image.jpeg\",\"date\":\"2022-07-06 00:00:00\",\"tag\":[\"Go\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Go 基础知识系列三: 等待组waitGroup\",\"link\":\"/posts/programming/go/waitgroup\"},\"next\":{\"text\":\"Go 基础知识系列五：Channel\",\"link\":\"/posts/programming/go/channel\"},\"title\":\"Go 基础知识系列四：接口interface\",\"description\":\"Go 基础知识系列四：接口interface\\n这篇文章总结了 Golang 的知识体系: `interface`，包括其中的底层实现等等。\\n:::warning 注意📢：\\n说起 Golang， 大家\"}},{\"route\":\"/posts/programming/go/mutex\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/go-cover1-slices.jpeg\",\"date\":\"2022-07-10 00:00:00\",\"tag\":[\"Go\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Go 基础知识系列五：Channel\",\"link\":\"/posts/programming/go/channel\"},\"next\":{\"text\":\"Go 基础知识系列七：延迟函数调用Defer\",\"link\":\"/posts/programming/go/defer\"},\"title\":\"Go 基础知识系列六：互斥锁mutex\",\"description\":\"Go 基础知识系列六：互斥锁mutex\\n `sync.Mutex` 互斥锁\\n`sync.Mutex` 是一个互斥锁，它的作用就是保护临界区，确保同一时间只有一个 Go 协程进入临界区。\\n什么是临界区？\"}},{\"route\":\"/posts/programming/go/waitgroup\",\"meta\":{\"sidebar\":false,\"cover\":\"https://hyper2t.github.io/waitgroup/featured-image.jpeg\",\"date\":\"2022-07-04 00:00:00\",\"tag\":[\"Go\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Go 基础知识系列二: 协程\",\"link\":\"/posts/programming/go/goroutine\"},\"next\":{\"text\":\"Go 基础知识系列四：接口interface\",\"link\":\"/posts/programming/go/interface\"},\"title\":\"Go 基础知识系列三: 等待组waitGroup\",\"description\":\"Go 基础知识系列三: 等待组waitGroup\\n这篇文章总结了 Golang 的知识体系: `waitGroup`，包括其中的底层实现等等。\\n很多情况下，我们正需要知道 `goroutine` 是否\"}},{\"route\":\"/posts/programming/rust/borrowing\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/rust-cover8.jpg\",\"date\":\"2023-11-09 00:00:00\",\"tag\":[\"Rust\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Rust基础知识系列七：所有权\",\"link\":\"/posts/programming/rust/ownership\"},\"title\":\"Rust基础知识系列八：引用与借用\",\"description\":\"Rust基础知识系列八：引用与借用\\n上节中提到，如果仅仅支持通过转移所有权的方式获取一个值，那会让程序变得复杂。 Rust 能否像其它编程语言一样，使用某个变量的指针或者引用呢？答案是可以。\\nRust\"}},{\"route\":\"/posts/programming/rust/disable-warning\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/background3.jpeg\",\"date\":\"2023-11-01 00:00:00\",\"tag\":[\"Rust\",\"编程基础\"],\"title\":\"如何在Rust示例中禁用未使用的代码警告\",\"description\":\"如何在Rust示例中禁用未使用的代码警告\\n 错误提示\\n在Rust代码中，有时你声明了一个变量、类型或定义了一些东西，但在代码中从未使用过，这时就会抛出一个错误。\\n比如说。\\n你声明了一个结构体，但从未构\"}},{\"route\":\"/posts/programming/rust/fundamental-type\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/rust-cover3.jpg\",\"date\":\"2023-11-04 00:00:00\",\"tag\":[\"Rust\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Rust基础知识系列二：语句、表达式、格式化输出\",\"link\":\"/posts/programming/rust/statement-expr-print\"},\"next\":{\"text\":\"Rust基础知识系列四：变量绑定\",\"link\":\"/posts/programming/rust/variable-bindings\"},\"title\":\"Rust基础知识系列三：数据基础类型\",\"description\":\"Rust基础知识系列三：数据基础类型\\n 数组和切片\\n数组（array）是一组拥有相同类型 T 的对象的集合，在内存中是连续存储的。数组使用中括号 `[]` 来创建，且它们的大小在编译时会被确定。数组的\"}},{\"route\":\"/posts/programming/rust/get-to-know-cargo\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/rust-cover.png\",\"date\":\"2023-11-02 00:00:00\",\"tag\":[\"Rust\",\"编程基础\"],\"sticky\":1,\"next\":{\"text\":\"Rust基础知识系列二：语句、表达式、格式化输出\",\"link\":\"/posts/programming/rust/statement-expr-print\"},\"title\":\"Rust基础知识系列一：认识Cargo\",\"description\":\"Rust基础知识系列一：认识Cargo\\n作为一门现代化语言，Rust 吸收了多个语言的包管理优点，为大家提供超级大杀器： `cargo`，真的，再挑剔的开发者，都对它赞不绝口。👍\\n总而言之，`car\"}},{\"route\":\"/posts/programming/rust/ownership\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/rust-cover7.jpg\",\"date\":\"2023-11-08 00:00:00\",\"tag\":[\"Rust\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Rust基础知识系列六：函数\",\"link\":\"/posts/programming/rust/rust-function\"},\"next\":{\"text\":\"Rust基础知识系列八：引用与借用\",\"link\":\"/posts/programming/rust/borrowing\"},\"title\":\"Rust基础知识系列七：所有权\",\"description\":\"Rust基础知识系列七：所有权\\n所有的程序都必须和计算机内存打交道，如何从内存中申请空间来存放程序的运行内容，如何在不需要的时候释放这些空间，成了重中之重，也是所有编程语言设计的难点之一。在计算机语言\"}},{\"route\":\"/posts/programming/rust/rust-function\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/rust-cover6.jpeg\",\"date\":\"2023-11-07 00:00:00\",\"tag\":[\"Rust\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Rust基础知识系列五：类型系统\",\"link\":\"/posts/programming/rust/types-system\"},\"next\":{\"text\":\"Rust基础知识系列七：所有权\",\"link\":\"/posts/programming/rust/ownership\"},\"title\":\"Rust基础知识系列六：函数\",\"description\":\"Rust基础知识系列六：函数\\nRust 的函数我们在之前已经见过不少，跟其他语言几乎没有什么区别。因此本章的学习之路将轻松和愉快，骚年们，请珍惜这种愉快，下一章你将体验到不一样的 Rust。\\n在函数界\"}},{\"route\":\"/posts/programming/rust/statement-expr-print\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/rust-cover2.png\",\"date\":\"2023-11-03 00:00:00\",\"tag\":[\"Rust\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Rust基础知识系列一：认识Cargo\",\"link\":\"/posts/programming/rust/get-to-know-cargo\"},\"next\":{\"text\":\"Rust基础知识系列三：数据基础类型\",\"link\":\"/posts/programming/rust/fundamental-type\"},\"title\":\"Rust基础知识系列二：语句、表达式、格式化输出\",\"description\":\"Rust基础知识系列二：语句、表达式、格式化输出\\nRust 的函数体是由一系列语句组成，最后由一个表达式来返回值，例如：\\n```rust\\nfn add_with_extra(x: i32, y: i3\"}},{\"route\":\"/posts/programming/rust/types-system\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/rust-cover5.jpg\",\"date\":\"2023-11-06 00:00:00\",\"tag\":[\"Rust\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Rust基础知识系列四：变量绑定\",\"link\":\"/posts/programming/rust/variable-bindings\"},\"next\":{\"text\":\"Rust基础知识系列六：函数\",\"link\":\"/posts/programming/rust/rust-function\"},\"title\":\"Rust基础知识系列五：类型系统\",\"description\":\"Rust基础知识系列五：类型系统\\nRust 提供了多种机制，用于改变或定义原生类型和用户定义类型。接下来会讲到：\\n- 原生类型的类型转换（cast）。\\n- 指定字面量的类型。\\n- 使用类型推断（typ\"}},{\"route\":\"/posts/programming/rust/variable-bindings\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/rust-cover4.jpg\",\"date\":\"2023-11-05 00:00:00\",\"tag\":[\"Rust\",\"编程基础\"],\"sticky\":1,\"prev\":{\"text\":\"Rust基础知识系列三：数据基础类型\",\"link\":\"/posts/programming/rust/fundamental-type\"},\"next\":{\"text\":\"Rust基础知识系列五：类型系统\",\"link\":\"/posts/programming/rust/types-system\"},\"title\":\"Rust基础知识系列四：变量绑定\",\"description\":\"Rust基础知识系列四：变量绑定\\nRust 通过静态类型确保类型安全。变量绑定可以在声明时说明类型，不过在多数情况下，编译器能够从上下文推导出变量的类型，从而大大减少了类型说明的工作。\\n使用 `let\"}},{\"route\":\"/posts/programming/webassembly/run-wasm-app-from-host\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/rust-and-wasm-cover.png\",\"date\":\"2024-03-11 00:00:00\",\"tag\":[\"Rust\",\"WebAssembly\",\"全栈开发\"],\"sticky\":1,\"prev\":{\"text\":\"WebAssembly系列一：Rust Web 全栈开发之编写 WebAssembly 应用\",\"link\":\"/posts/programming/webassembly/webassembly-full-stack-app\"},\"title\":\"WebAssembly系列二：使用 WasmEdge Rust SDK 构建并运行 WebAssembly 应用程序\",\"description\":\"WebAssembly系列二：使用 WasmEdge Rust SDK 构建并运行 WebAssembly 应用程序\\n在本文中，我们将介绍如何创建 WebAssembly 应用程序[^wasm]（也是\"}},{\"route\":\"/posts/programming/webassembly/webassembly-full-stack-app\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/rust-and-wasm-cover.png\",\"date\":\"2024-03-02 00:00:00\",\"tag\":[\"Rust\",\"WebAssembly\",\"全栈开发\"],\"sticky\":1,\"next\":{\"text\":\"WebAssembly系列二：使用 WasmEdge Rust SDK 构建并运行 WebAssembly 应用程序\",\"link\":\"/posts/programming/webassembly/run-wasm-app-from-host\"},\"title\":\"WebAssembly系列一：Rust Web 全栈开发之编写 WebAssembly 应用\",\"description\":\"WebAssembly系列一：Rust Web 全栈开发之编写 WebAssembly 应用\\n WebAssembly介绍\\n 什么是 WebAssembly？\\nWebAssembly 是一种新的编码方\"}},{\"route\":\"/posts/programming/go/client-go/api-machinery\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/client-go-cover.jpeg\",\"author\":\"熬小剑\",\"date\":\"2023-01-12 00:00:00\",\"tag\":[\"Go\",\"Client-go\"],\"sticky\":1,\"prev\":{\"text\":\"Client-go系列四: Informer实战\",\"link\":\"/posts/programming/go/client-go/informer-exercise\"},\"next\":{\"text\":\"Client-go系列六：Client-go类库（上）\",\"link\":\"/posts/programming/go/client-go/client-go-pkg-part1\"},\"title\":\"Client-go系列五：API Machinery\",\"description\":\"Client-go系列五：API Machinery\\n本章探讨了 Kubernetes API Machinery，它提供了用于处理遵循 Kubernetes API 对象约定的API对象的实用工具。\"}},{\"route\":\"/posts/programming/go/client-go/client-go-pkg-part1\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/client-go-cover.jpeg\",\"author\":\"熬小剑\",\"date\":\"2023-01-21 00:00:00\",\"tag\":[\"Go\",\"Client-go\"],\"sticky\":1,\"prev\":{\"text\":\"Client-go系列五：API Machinery\",\"link\":\"/posts/programming/go/client-go/api-machinery\"},\"next\":{\"text\":\"Client-go系列七：Client-go类库（下）\",\"link\":\"/posts/programming/go/client-go/client-go-pkg-part2\"},\"title\":\"Client-go系列六：Client-go类库（上）\",\"description\":\"Client-go系列六：Client-go类库（上）\\n本章探讨了 Client-go 库，它是一个高级别库，开发者可以使用 Go 语言与 Kubernetes API 进行交互。Client-go \"}},{\"route\":\"/posts/programming/go/client-go/client-go-pkg-part2\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/client-go-cover.jpeg\",\"author\":\"熬小剑\",\"date\":\"2023-01-25 00:00:00\",\"tag\":[\"Go\",\"Client-go\"],\"sticky\":1,\"prev\":{\"text\":\"Client-go系列六：Client-go类库（上）\",\"link\":\"/posts/programming/go/client-go/client-go-pkg-part1\"},\"title\":\"Client-go系列七：Client-go类库（下）\",\"description\":\"Client-go系列七：Client-go类库（下）\\n 删除资源\\n要从集群中删除资源，可以对你要删除的资源使用删除方法。例如，要从 `project1` 命名空间中删除一个名为 `nginx-pod\"}},{\"route\":\"/posts/programming/go/client-go/clientset\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/client-go-cover.jpeg\",\"date\":\"2022-12-22 00:00:00\",\"tag\":[\"Go\",\"Client-go\"],\"sticky\":1,\"prev\":{\"text\":\"Client-go系列一: Client-go知识体系\",\"link\":\"/posts/programming/go/client-go/intro\"},\"next\":{\"text\":\"Client-go系列三：认识Informer\",\"link\":\"/posts/programming/go/client-go/informer\"},\"title\":\"Client-go系列二: 认识ClientSet\",\"description\":\"Client-go系列二: 认识ClientSet\\n\\n ClientSet 简介\\n`ClientSet`使用预生成的 API 对象来与 kube-apiserver 进行交互，类似于 RPC 的变成体\"}},{\"route\":\"/posts/programming/go/client-go/informer-exercise\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/client-go-cover.jpeg\",\"date\":\"2023-01-07 00:00:00\",\"tag\":[\"Go\",\"Client-go\"],\"sticky\":1,\"prev\":{\"text\":\"Client-go系列三: 认识Informer\",\"link\":\"/posts/programming/go/client-go/informer\"},\"next\":{\"text\":\"Client-go系列五：API Machinery\",\"link\":\"/posts/programming/go/client-go/api-machinery\"},\"title\":\"Client-go系列四：Informer实战\",\"description\":\"Client-go系列四：Informer实战\\n利用 `Informer` 机制来开发一个简单的 `controller` 来清理 kubernetes 集群内异常状态的 pod .\\n 背景\\n平时 k\"}},{\"route\":\"/posts/programming/go/client-go/informer\",\"meta\":{\"sidebar\":false,\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/client-go-cover.jpeg\",\"date\":\"2022-12-25 00:00:00\",\"tag\":[\"Go\",\"Client-go\"],\"sticky\":1,\"prev\":{\"text\":\"Client-go系列二: 认识ClientSet\",\"link\":\"/posts/programming/go/client-go/clientset\"},\"next\":{\"text\":\"Client-go系列四：Informer实战\",\"link\":\"/posts/programming/go/client-go/informer-exercise\"},\"title\":\"Client-go系列三：认识Informer\",\"description\":\"Client-go系列三：认识Informer\\nInformer 对于实现 kubernetes 的 `controller` 模式非常重要.\\n Informer 简介\\n\\n&gt;\\n&gt; 这显然是\"}},{\"route\":\"/posts/programming/go/client-go/intro\",\"meta\":{\"sidebar\":false,\"date\":\"2022-10-02 00:00:00\",\"tag\":[\"Go\",\"Client-go\"],\"sticky\":1,\"next\":{\"text\":\"Client-go系列二: 认识ClientSet\",\"link\":\"/posts/programming/go/client-go/clientset\"},\"title\":\"Client-go系列一：Client-go知识体系\",\"description\":\"Client-go系列一：Client-go知识体系\\n初步认识 Client-go 主体框架.\\n 关于client-go\\n`client-go`是kubernetes官方提供的go语言的客户端库，go\",\"cover\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/client-go-image.png\"}}],\"footer\":{\"copyright\":\"MIT License | 皮特ᴾᵗ\"},\"themeColor\":\"vp-green\",\"author\":\"皮特ᴾᵗ\",\"friend\":[{\"nickname\":\"皮特ᴾᵗ\",\"des\":\"你的指尖用于改变世界的力量\",\"avatar\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog@gh-pages/selfie.jpeg\",\"url\":\"https://cs.hyperter.top\"},{\"nickname\":\"意琦行\",\"des\":\"指月小筑(探索云原生)\",\"avatar\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/yiqixing.jpg\",\"url\":\"https://www.lixueduan.com/\"},{\"nickname\":\"熬小剑\",\"des\":\"Service Mesh布道师, 云原生布道师, Dapr Approver\",\"avatar\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/skyao.png\",\"url\":\"https://skyao.io/\"},{\"nickname\":\"原子之音\",\"des\":\"C++ Rust Unreal大家加油\",\"avatar\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/yuanZiZhiYin.jpg\",\"url\":\"https://space.bilibili.com/437860379\"}],\"comment\":{\"repo\":\"hyperter96/tech-blog\",\"repoId\":\"R_kgDOLckbDg\",\"category\":\"General\",\"categoryId\":\"DIC_kwDOLckbDs4CdyEa\",\"label\":\"评论\",\"icon\":\"<svg enable-background=\\\"new 0 0 512 512\\\" height=\\\"512px\\\" id=\\\"Layer_1\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 512 512\\\" width=\\\"512px\\\" xml:space=\\\"preserve\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\"><path d=\\\"M170.476,166.19h155.097c4.285,0,7.76-3.469,7.76-7.754s-3.475-7.765-7.76-7.765H170.476c-4.285,0-7.754,3.48-7.754,7.765  S166.191,166.19,170.476,166.19z\\\"/><path d=\\\"M348.088,203.362H202.74c-4.284,0-7.759,3.469-7.759,7.754s3.475,7.765,7.759,7.765h145.348c4.284,0,7.754-3.48,7.754-7.765  S352.372,203.362,348.088,203.362z\\\"/><path d=\\\"M306.695,256.052H170.476c-4.285,0-7.754,3.469-7.754,7.754c0,4.284,3.469,7.754,7.754,7.754h136.219  c4.279,0,7.754-3.47,7.754-7.754C314.448,259.521,310.974,256.052,306.695,256.052z\\\"/><path d=\\\"M396.776,86.288H115.225c-29.992,0-54.403,22.562-54.403,50.308v154.83c0,27.735,24.411,50.297,54.403,50.297h166.034  l119.812,83.989v-84.135c27.996-2.038,50.108-23.753,50.108-50.151v-154.83C451.179,108.85,426.768,86.288,396.776,86.288z   M427.906,291.426c0,14.902-13.972,27.025-31.131,27.025h-18.978v62.523l-89.193-62.523h-173.38  c-17.164,0-31.131-12.123-31.131-27.025v-154.83c0-14.913,13.967-27.035,31.131-27.035h281.551  c17.159,0,31.131,12.123,31.131,27.035V291.426z\\\"/></svg>\",\"mobileMinify\":false,\"inputPosition\":\"bottom\",\"lang\":\"zh-CN\",\"mapping\":\"pathname\"},\"hotArticle\":{\"title\":\"🔥 精选文章\",\"nextText\":\"换一组\",\"pageSize\":3,\"empty\":\"暂无精选内容\"},\"popover\":{\"title\":\"公告\",\"mobileMinify\":true,\"body\":[{\"type\":\"text\",\"content\":\"👇微信扫码添加好友👇\"},{\"type\":\"image\",\"src\":\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/qrcode3.png\"},{\"type\":\"button\",\"content\":\"云原生文档\",\"link\":\"https://ikubevirt.cn\"},{\"type\":\"button\",\"content\":\"生活博客\",\"props\":{\"type\":\"success\"},\"link\":\"https://life.hyperter.top\"}],\"duration\":-1},\"buttonAfterArticle\":{\"openTitle\":\"投币\",\"closeTitle\":\"下次一定\",\"content\":\"<img src=\\\"https://cdn.jsdelivr.net/gh/hyperter96/tech-blog/docs/assets/images/wechatpay-code.jpg\\\">\",\"icon\":\"wechatPay\"}},\"sidebar\":[{\"text\":\"\",\"items\":[]}],\"outline\":{\"level\":[2,3],\"label\":\"目录\"},\"returnToTopLabel\":\"回到顶部\",\"sidebarMenuLabel\":\"相关文章\",\"lastUpdatedText\":\"上次更新于\",\"logo\":\"/favicon.ico\",\"editLink\":{\"pattern\":\"https://github.com/hyperter96/tech-blog/tree/main/docs/:path\",\"text\":\"去 GitHub 上编辑内容\"},\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"面试\",\"items\":[{\"text\":\"TCP篇\",\"link\":\"/posts/interview/tcp.html\"}]},{\"text\":\"趣味\",\"items\":[{\"text\":\"逮住那只猫！\",\"link\":\"/fun/catch-the-cat.html\"}]},{\"text\":\"关于我\",\"link\":\"/aboutme.html\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/hyperter96/tech-blog\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>